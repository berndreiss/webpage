<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mnemonic Word Finder - Bernd's Homepage</title>
  <link rel="stylesheet" href="styles.css?v=2.0.7">
  <script>
    // Set theme immediately and body background
    try {
      const savedTheme = localStorage.getItem('theme');
      const systemTheme = (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) ? 'light' : 'dark';
      const theme = savedTheme || systemTheme;
      document.documentElement.setAttribute('data-theme', theme);
      document.write('<style>body{background-color:' + (theme === 'light' ? '#ffffff' : '#1a1a1a') + '!important;}</style>');
    } catch (e) {
      document.documentElement.setAttribute('data-theme', 'dark');
      document.write('<style>body{background-color:#1a1a1a!important;}</style>');
    }
  </script>
  <style>
    .mnemo-form {
      margin: 2rem 0;
      padding: 1.5rem;
      background-color: var(--card-bg);
      border-radius: 8px;
      box-shadow: 0 2px 4px var(--shadow-color);
      border: 1px solid var(--border-color);
    }

    .form-group {
      margin-bottom: 1rem;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: bold;
      color: var(--text-color);
    }

    .form-group input {
      width: 100%;
      max-width: 400px;
      padding: 0.75rem;
      font-size: 1rem;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      background-color: var(--bg-color);
      color: var(--text-color);
      transition: border-color 0.3s;
    }

    .form-group input:focus {
      outline: none;
      border-color: var(--link-color);
    }

    .submit-btn {
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      background-color: var(--link-color);
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .submit-btn:hover {
      background-color: var(--link-hover-color);
    }

    .submit-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .results-section {
      margin-top: 2rem;
    }

    .result-group {
      margin-bottom: 1.5rem;
      padding: 1.5rem;
      background-color: var(--card-bg);
      border-radius: 8px;
      box-shadow: 0 2px 4px var(--shadow-color);
      border: 1px solid var(--border-color);
    }

    .result-number {
      font-size: 1.25rem;
      font-weight: bold;
      margin-bottom: 0.5rem;
      color: var(--text-color);
    }

    .result-pattern {
      font-family: monospace;
      font-size: 0.85rem;
      color: var(--text-color);
      opacity: 0.7;
      margin-bottom: 1rem;
      padding: 0.5rem;
      background-color: var(--bg-color);
      border-radius: 4px;
      border: 1px solid var(--border-color);
    }

    .result-words {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .word-tag {
      padding: 0.4rem 0.8rem;
      background-color: var(--nav-active-bg);
      color: white;
      border-radius: 4px;
      font-size: 0.9rem;
    }

    .no-results {
      color: var(--text-color);
      opacity: 0.7;
      font-style: italic;
    }

    .loading {
      text-align: center;
      padding: 2rem;
      color: var(--text-color);
      opacity: 0.7;
    }

    .error-message {
      padding: 1rem;
      background-color: var(--card-bg);
      border: 1px solid #c62828;
      color: #c62828;
      border-radius: 4px;
      margin-bottom: 1rem;
    }

    .info-box {
      background-color: var(--card-bg);
      padding: 1.5rem;
      border-radius: 8px;
      box-shadow: 0 2px 4px var(--shadow-color);
      border: 1px solid var(--border-color);
      margin-bottom: 2rem;
    }

    .info-box h4 {
      margin-top: 0;
      color: var(--text-color);
    }

    .info-box ul {
      margin-bottom: 0;
    }

    .info-box li {
      margin-bottom: 0.25rem;
    }
  </style>
</head>
<body>
  <!-- Header will be inserted here by JavaScript -->
  <div id="header-placeholder"></div>

  <!-- Main content -->
  <main>
    <div class="page-intro">
      <h2>Mnemonic Word Finder</h2>
      <p>Enter a number to find words that match the Major System mnemonic pattern.</p>
    </div>

    <div class="container">
      <div class="info-box">
        <h4>How it works:</h4>
        <p>The Major System converts digits (0-9) into consonant sounds, making numbers easier to remember by turning them into words. Enter any number to get word suggestions.</p>
        <ul>
          <li>0 = s, z, c</li>
          <li>1 = t, d, th</li>
          <li>2 = n</li>
          <li>3 = m</li>
          <li>4 = r</li>
          <li>5 = l</li>
          <li>6 = j, g, sh, ch, dg, zh</li>
          <li>7 = k, c, g, q, ch, qu</li>
          <li>8 = f, v</li>
          <li>9 = b, p</li>
        </ul>
      </div>

      <div id="word-list-status" style="display: none;"></div>

      <form id="mnemo-form" class="mnemo-form">
        <div class="form-group">
          <label for="number-input">Enter Number(s):</label>
          <input
            type="text"
            id="number-input"
            name="numbers"
            placeholder="e.g., 42 or 123 456"
            required
            pattern="[0-9\s]+"
            title="Please enter only numbers and spaces"
          />
        </div>
        <button type="submit" class="submit-btn">Find Words</button>
      </form>

      <div id="results" class="results-section"></div>
    </div>
  </main>

  <!-- Footer will be inserted here by JavaScript -->
  <div id="footer-placeholder"></div>

  <!-- Load shared components -->
  <script src="components.js?v=2.0.9"></script>

  <!-- Load word list -->
  <script src="words.js"></script>

  <script>
    // Mnemonic Major System - Client-side implementation
    let wordList = [];
    let wordListLoaded = false;

    // Load word list on page load
    function loadWordList() {
      const statusDiv = document.getElementById('word-list-status');
      try {
        // Use the embedded word list from words.js
        if (typeof WORD_LIST !== 'undefined') {
          wordList = WORD_LIST.map(word => word.trim().toLowerCase()).filter(word => word.length > 0);
          wordListLoaded = true;
          console.log('Loaded ' + wordList.length + ' words');
        } else {
          throw new Error('Word list not found');
        }
      } catch (error) {
        console.warn('Could not load word list, using basic fallback');
        console.error(error);
        // Use a basic fallback word list
        wordList = ['the', 'be', 'to', 'of', 'and', 'a', 'in', 'that', 'have', 'it'];
        wordListLoaded = true;
        if (statusDiv) {
          statusDiv.className = 'error-message';
          statusDiv.style.display = 'block';
          statusDiv.innerHTML = 'Warning: Could not load full word list. Using minimal fallback (' + wordList.length + ' words).';
        }
      }
    }

    // Convert digit to phonetic pattern
    function digitToPattern(digit) {
      const patterns = {
        '0': '[scz]',
        '1': '([dt]|th)',
        '2': '[n]',
        '3': '[m]',
        '4': '[r]',
        '5': '[l]',
        '6': '([jg]|sh|ch|dg|zh)',
        '7': '([kcgq]|ch|qu)',
        '8': '[fv]',
        '9': '[bp]'
      };
      return patterns[digit] || '';
    }

    // Build regex pattern from number
    function buildPattern(number) {
      const vowels = '[aeiou]*';
      let pattern = '^' + vowels;

      for (let digit of number) {
        pattern += digitToPattern(digit);
        pattern += vowels;
      }

      pattern += '$';
      return pattern;
    }

    // Find words matching the pattern
    function findMatchingWords(number) {
      const pattern = buildPattern(number);
      const regex = new RegExp(pattern, 'i');

      console.log('Searching for number:', number);
      console.log('Pattern:', pattern);
      console.log('Word list size:', wordList.length);

      const matches = wordList.filter(word => regex.test(word));
      console.log('Matches found:', matches.length);
      if (matches.length > 0 && matches.length <= 10) {
        console.log('Sample matches:', matches);
      }

      return {
        number: number,
        pattern: pattern,
        words: matches
      };
    }

    // Handle form submission
    document.getElementById('mnemo-form').addEventListener('submit', async function(e) {
      e.preventDefault();

      const numberInput = document.getElementById('number-input');
      const resultsDiv = document.getElementById('results');
      const submitBtn = e.target.querySelector('.submit-btn');

      // Show loading
      resultsDiv.innerHTML = '<div class="loading">Searching for matching words...</div>';
      submitBtn.disabled = true;

      try {
        // Ensure word list is loaded
        if (!wordListLoaded) {
          loadWordList();
        }

        // Get numbers from input
        const input = numberInput.value.trim();
        const numbers = input.split(/\s+/).filter(n => n.length > 0);

        if (numbers.length === 0) {
          throw new Error('Please enter at least one number');
        }

        // Process each number
        const results = numbers.map(num => findMatchingWords(num));

        // Display results
        if (results.length > 0) {
          let html = '';
          results.forEach(result => {
            html += '<div class="result-group">';
            html += '<div class="result-number">Number: ' + result.number + '</div>';
            html += '<div class="result-pattern">Pattern: ' + result.pattern + '</div>';

            if (result.words && result.words.length > 0) {
              html += '<div class="result-words">';
              result.words.forEach(word => {
                html += '<span class="word-tag">' + word + '</span>';
              });
              html += '</div>';
            } else {
              html += '<div class="no-results">No matching words found.</div>';
            }

            html += '</div>';
          });
          resultsDiv.innerHTML = html;
        } else {
          resultsDiv.innerHTML = '<div class="no-results">No results found.</div>';
        }
      } catch (error) {
        resultsDiv.innerHTML = '<div class="error-message">Error: ' + error.message + '</div>';
      } finally {
        submitBtn.disabled = false;
      }
    });

    // Load word list when page loads
    loadWordList();
  </script>
</body>
</html>
